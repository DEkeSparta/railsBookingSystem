<p id="notice"><%= notice %></p>

<div class='container' id='booking_date_select'>
  <div class ='row'>
    <div class='col-3'>
      <%= form_with(local: true, method: :get) do |form| %>
      <div class='forms'>
      <div class="field">
        <h4> <%= form.label params[:date] %> </h4>
        <%= form.date_field :date, {:class => 'form-control date'} %>
        <br>
        <div class="actions field">
          <%= form.submit "Select", method: :reload , :class => 'btn btn-lg btn-primary btn-signin date' %>
        </div>
        <% end %>
      </div>
      </div>
    </div>
    <div class='col-9'>
      <h1 class="text-center">Bookings</h1>
    </div>
  </div>
</div>




<br>
<br>
<div class="col-md-12 table-responsive">
  <table class="table">
    <thead>
      <th></th>
      <% @Rooms.each do |room| %>
        <th><%= room.name %></th>
      <% end %>
    </thead>
  <tbody>
    <% @times.each_with_index do |time,i| %>
    <tr>
      <td><%= time %></td>
      <% @Rooms.each do |room| %>
        <% if room.isFree params[:date], time, @times[i+1]  %>
        <% if current_user.present? %>
          <td onclick="location.href='/bookings/new';"></td>
        <% else %>
          <td></td>
        <% end %>
        <% else %>
          <td class="bg-warning" onclick="location.href='/bookings/<%= room.bookings.all.first.id %>';">
            <% text = room.bookings.all.first.description %>
            <% if text.length <= 15 %>
              <%= text %>
            <% else %>
              <%= "#{text[0...12]}..." %>
            <% end %>
          </td>
        <% end %>
      <% end %>
    </tr>
    <% end %>
  </table>
</div>

<br>

<%= link_to 'New Booking', new_booking_path %>
